# 天気アプリケーション 要件定義書

## 1. プロジェクト概要

### 1.1 目的
47都道府県の天気情報を取得・表示し、取得履歴をデータベースに保存するWebアプリケーション

### 1.2 対象ユーザー
- 一般ユーザー（日本国内の天気を知りたい人）

### 1.3 開発期間
- 40営業日（約2ヶ月）

## 2. 機能要件

### 2.1 トップページ（都道府県一覧）
- **機能**: 47都道府県の一覧を表示
- **表示項目**:
  - 都道府県名
  - 都道府県コード
  - 代表地点の緯度・経度
- **操作**:
  - 都道府県をクリックすると詳細ページへ遷移

### 2.2 天気詳細ページ
- **機能**: 選択した都道府県の天気情報を表示
- **表示項目**:
  - 現在の天気
    - 気温（℃）
    - 天気コード（晴れ、曇り、雨など）
    - 風速（m/s）
    - 湿度（%）
  - 週間天気予報（7日間）
    - 日付
    - 最高気温
    - 最低気温
    - 天気コード
- **データ取得**:
  - Open-Meteo APIから取得
  - 取得した情報はデータベースに保存

### 2.3 データ保存機能
- **機能**: API取得データの履歴保存
- **保存項目**:
  - 都道府県ID
  - 取得日時
  - 気温
  - 天気コード
  - その他の気象データ

### 2.4 UI/UX機能
- **ローディング表示**: API呼び出し中の待機画面
- **エラーハンドリング**: わかりやすいエラーメッセージ
- **レスポンシブデザイン**: スマホ・タブレット対応
- **天気アイコン**: 天気コードに応じたビジュアル表示
- **お気に入り機能**: よく見る都道府県の保存（LocalStorage）

## 3. 非機能要件

### 3.1 パフォーマンス
- ページ読み込み時間: 3秒以内
- API レスポンス時間: 5秒以内

### 3.2 可用性
- 稼働率: 開発環境では制限なし
- エラー時の適切なメッセージ表示

### 3.3 セキュリティ
- SQLインジェクション対策
- XSS対策
- CSRF対策（Spring Securityで対応）

### 3.4 互換性
- ブラウザ対応: Chrome, Firefox, Edge（最新版）
- モバイル対応: iOS Safari, Android Chrome

### 3.5 保守性
- コードの可読性
- 適切なコメント
- ドキュメント整備

## 4. 技術スタック

### 4.1 バックエンド
- Java 17
- Spring Boot 3.x
- Spring Data JPA
- Gradle

### 4.2 フロントエンド
- Thymeleaf
- HTML5/CSS3
- JavaScript（バニラ）

### 4.3 データベース
- MySQL 8.0

### 4.4 外部API
- Open-Meteo API (https://open-meteo.com/)

## 5. 画面一覧

| 画面ID | 画面名 | URL | 説明 |
|--------|--------|-----|------|
| HOME | トップページ | / | 47都道府県一覧 |
| DETAIL | 天気詳細 | /weather/{prefectureId} | 選択都道府県の天気 |
| ERROR_404 | 404エラー | /error/404 | ページが見つからない |
| ERROR_500 | 500エラー | /error/500 | サーバーエラー |

## 6. データベース構成（概要）

### 6.1 テーブル一覧
1. prefectures（都道府県マスタ）
2. weather_records（天気記録）
3. daily_forecasts（日次予報）

詳細は別途ER図で定義

## 7. 外部連携

### 7.1 Open-Meteo API
- **エンドポイント**: https://api.open-meteo.com/v1/forecast
- **認証**: 不要（無料プラン）
- **レート制限**: 10,000リクエスト/日

## 8. 制約事項・前提条件

### 8.1 制約事項
- インターネット接続が必要
- Open-Meteo APIの利用制限に従う

### 8.2 前提条件
- JDK 17以上
- MySQL 8.0以上
- モダンブラウザ

## 9. 今後の拡張性

### 9.1 将来的な機能追加候補
- ユーザー認証機能
- お気に入り地点の永続化
- 天気アラート機能
- 過去の天気データ分析

## 10. 成功基準

- [ ] 47都道府県の天気が正しく表示される
- [ ] 週間天気予報が表示される
- [ ] データベースに履歴が保存される
- [ ] スマホでも快適に閲覧できる
- [ ] エラーが適切に処理される
